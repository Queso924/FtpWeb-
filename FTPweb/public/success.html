<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Archivo Subido</title>
  <link rel="stylesheet" href="styles.css">

 <script>
  document.addEventListener("DOMContentLoaded", function() {
    const urlParams = new URLSearchParams(window.location.search);
    const file = urlParams.get("file");
    const expirationMinutes = parseInt(urlParams.get("time"), 10);

    if (file) {
      const downloadUrl = window.location.origin + "/download?file=" + encodeURIComponent(file);
      document.getElementById("downloadLink").href = downloadUrl;
    }

    if (!isNaN(expirationMinutes) && expirationMinutes > 0) {
      let timeLeft = expirationMinutes * 60;
      function updateCountdown() {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        document.getElementById("countdown").textContent = `${minutes}m ${seconds}s`;
        if (timeLeft <= 0) {
          document.getElementById("countdown").textContent = "⏳ Archivo Expirado";
          document.getElementById("downloadLink").style.display = "none";
        } else {
          timeLeft--;
          setTimeout(updateCountdown, 1000);
        }
      }
      updateCountdown();
    }
  });

  function copyLink() {
    navigator.clipboard.writeText(document.getElementById("downloadLink").href);
    alert("Enlace copiado al portapapeles ✅");
  }
</script>

</head>
<body>
  <div class="container">
    <h1>✅ Archivo Subido</h1>
    <a class="download-link" id="downloadLink" href="#" target="_blank">📥 Descargar Archivo</a>
    <button class="copy-button" onclick="copyLink()">📋 Copiar Enlace</button>
    <br><br>
    <a class="download-link" href="/">⬅️ Subir otro archivo</a>
  </div>
</body>
</html>
